### 1. Назначение
- Проверяет версии Zabbix агентов на удалённых хостах
- Определяет тип и версию ОС каждого хоста
- Сравнивает текущую версию агента с ожидаемой для данного типа ОС
- Формирует отчёт и отправляет его в Telegram

### 2. Основные компоненты

#### 2.1. Конфигурационные параметры
```bash
# Версии Zabbix агентов для разных ОС
VERSION_UBUNTU="7.4.0"
VERSION_DEBIAN="7.4.0"
VERSION_REDOS="7.0.12"
VERSION_CENTOS="7.0.0"

# Настройки Telegram бота
BOT_TOKEN="Ваш токин"
CHAT_ID="Ваш чат айди"
API_URL="https://api.telegram.org/bot${BOT_TOKEN}/sendMessage"

# Файл инвентаризации Ansible
INVENTORY="inventory.ini"
```
#### 2.2. Логика работы
1. **Чтение inventory файла**
   Скрипт ищет секцию `[zabbix_agents]` в файле `inventory.ini` и достает список хостов.

2. **Сбор информации**  
   Для каждого хоста выполняется:
   - Получение версии Zabbix-агента через `zabbix_get`
   - Определение ОС и её версии
   - Сравнение текущей версии агента с эталонной

3. **Формирование отчёта**  
   Создаётся структурированное сообщение в формате Markdown.

4. **Отправка в Telegram**  
   Сообщение отправляется через Telegram Bot API.

### 3. Особенности

#### 3.1. Определение ОС
Используются два метода:
1. Запрос полной информации об ОС: `system.sw.os[full]`
2. Запрос только названия ОС: `system.sw.os[name]`

Для разных ОС применяются разные регулярные выражения:
```bash
# Для RedOS
grep -oP 'Red Soft \K[0-9.]+'

# Для Ubuntu
grep -oP 'Ubuntu \K[0-9.]+'

# Для Debian/CentOS - аналогично
```

#### **3.2. Обработка ошибок**
- Если хост не отвечает (`-z "$VERSION"`), добавляется соответствующая пометка
- Для неизвестных ОС выводится "Unknown"

#### **3.3. Экранирование для Telegram**
Специальные символы экранируются для корректного отображения в MarkdownV2:
```bash
sed -e 's/\./\\./g' -e 's/\-/\\-/g' ...
```

### 5. Требования
1. Установленный `zabbix_get` на машине, где выполняется скрипт (лучше на сервере с zabbix сервером)
2. Настроенный доступ к Zabbix-агентам
3. Файл `inventory.ini` в формате Ansible
4. Доступ к интернету для отправки в Telegram